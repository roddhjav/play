# play - Apparmor play machine
# Copyright (C) 2025 Alexandre Pujol <alexandre@pujol.io>
# SPDX-License-Identifier: UNLICENSED

# Don't confine members whose primary group is 'admin' who are not specifically
# confined. Systems without this special primary group may want to define an
# unconfined 'root' hat in this manner (depending on site policy).

hat root flags=(complain) {
  include <abstractions/authentication>
  include <abstractions/nameservice-strict>

  capability dac_override,
  capability audit_write,
  capability setgid,
  capability setuid,

  @{shells_path}  rPx -> role_root,

  /etc/default/su r,
  @{etc_ro}/environment r,

  include if exists <local/mappings_root>
}

# vim:syntax=apparmor
